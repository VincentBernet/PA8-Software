<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Paramètres</title>

		<meta
			http-equiv="Content-Security-Policy"
			content="script-src 'self' 'unsafe-inline';"
		/>
		<link rel="stylesheet" href="../css/parametre.css" />
        <link rel="stylesheet" href="../css/header.css" />

        <!-- Script assurant la déconnexion et d'autres fonctions -->
		<script defer src="../js/index.js"></script>
        <script defer src="../js/parametre.js"></script>
	</head>

	<body>
		<!-- Container flex comprenant et les boutons pour changer d'analyse et la rubrique-->
		<div class="Option_Graphe_Container">
			<div class = "bouton_gauche">
				<img id="logotext"  src="../ressource/image/Logo_bleu.png"/>
				<div id="container_Compteur">
					<table>
						<tr>
							<td>Nombre de Client</td> 
							<td class="odometer" id="Ccap"></td>
						</tr>
						<tr>
							<td>Capacité Restante</td>
							<td class="odometer" id="CapRestante"></td>
						</tr>
						<tr><span id="alert"></span></tr>
						<tr></tr>
					</table>
				</div>
				<br><br>
				<br><br>
				<a id="redirect_Dashboard" class="button" href="#">Dashboard</a>
				<br>
				<a id="redirect_Analyse" class="button" href="#">Analyse</a>
				<br>
				<a id="redirect_Parameter" class="button" href="#">Paramètre</a>
				<br>
				<a id="redirect_Disconnection" class="button" href="#">Déconnexion</a>
				<br>
			</div>
		</div>
        
			<!-- Container avec le graphe choisi (en format png) -->
		<div id="Container_graphe">
                Sélectionnez le graphe que vous souhaitez modifier : 
                <!--<form method="POST"> -->
                    <select id="Graph_Selected">
                        <option value="Afluence">Affluence Graphe</option>
                        <option value="HeatMap">HeatMap</option>
                        <option value="Graphe3">Graphe3</option>
                        <option value="DailyAnalysis">Daily Analysis</option>
                      </select>
                <button id="redirect_InscriptionLoc">Rajouter un nouveau Magasin</button>
                <br>
                <br>
                <textarea id="code_python" rows="30" cols="130">
# Affluence Graphe Code

                    import pandas as pd
                    from matplotlib import pyplot as plt
                    import plotly.express as px

                    df = pd.read_csv("../../ressource/data/output.csv", usecols = ['time', 'class','trackID'])
                    datetime = pd.to_datetime(df['time'])
                    df = df.set_index(pd.DatetimeIndex(datetime))
                    df.head(3)

                    affluence = df.groupby(df.index.second).trackID.nunique()
                    affluence.head(3)
                    x = df.index.second.unique()
                    y = affluence
                    fig = px.bar(df, x, y, title='Affluence/Seconde',
                        labels={
                            "y": "Nombre de badauds",
                            "x": "Horaire (en seconde)"
                        },)

                    fig.update_layout(plot_bgcolor="rgba(0,0,0,0)",
                        paper_bgcolor="rgba(0,0,0,0)",
                        font_family="Taoma",
                        font_color="white",
                        font_size=15,
                        title_font_family="Taoma",
                        title_font_color="white",
                        title_font_size=30,
                        legend_title_font_color="green",
                        width= 1248,
                        height= 648)

                        fig.write_image(file='Affluence.png', format='.png')
                        fig.show()</textarea>
                    <br><br>
                <!-- Implenter un input pour choisir un fichier à importer -->
                <input id="SelectFile" type="file">
                
                <button   id="RestaurerBtn" style="color:red;">Restaurer les paramètres par défauts</button>
                <button  id="ValidateBtn">Valider</button>
            <!--</form> -->
            </div>
		</div>
        
        <!-- Script pour modifier le code source souhaiter selon le "select" sélectionner + Alert si le boutton restaurer ou valider est activé-->
		<script>
			const AffluenceBtn = document.getElementById('RestaurerBtn')
			AffluenceBtn.addEventListener('click', (event) => {
                confirm("Attention : Vous vous apprêtez à restaurer tous les paramètres par défauts, graphes compris !\n Confirmer ?")
            })
            

            const ValidateBtn = document.getElementById('ValidateBtn')
			ValidateBtn.addEventListener('click', (event) => {
                var graphSelection = document.getElementById("Graph_Selected")
                var Graph_Selected = graphSelection.value
                alert("Le graphe d'"+Graph_Selected+" a bien été modifié")
            })


            const SelectBtn = document.getElementById('Graph_Selected')
			SelectBtn.addEventListener('click', (event) => {
                var graphSelection = document.getElementById("Graph_Selected")
                var Graph_Selected = graphSelection.value
                document.getElementById('code_python').value = '# '+ Graph_Selected +' Graphe Code \n'
            })
        </script>	
        
		

	</body>
</html>
